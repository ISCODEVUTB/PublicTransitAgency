<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Técnico - Panel</title>
  <link rel="stylesheet" href="{{ url_for('static', path='css/tecnico.css') }}">
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <h2>Técnico</h2>
      <button class="menu-btn" id="btnHistorial">Consultar historial de bus</button>
      <button class="menu-btn" id="btnItinerario">Itinerario</button>
      <button class="menu-btn" id="btnMantenimiento">Registrar Mantenimiento</button>
      <button class="menu-btn" id="btnAlertas">Alertas</button>
    </div>
    <div class="main-content">
      <div class="header">
        <h1>Panel General del Técnico</h1>
      </div>

      <div class="info-section">
        <div class="info-box">
          <h3>Buses en Mantenimiento</h3>
          <p>12</p>
        </div>
        <div class="info-box">
          <h3>Próximos Mantenimientos</h3>
          <p>5</p>
        </div>
        <div class="info-box">
          <h3>Historial Técnico</h3>
          <p>45 registros</p>
        </div>
      </div>
    </div>
  </div>
  <script>
    // ✅ Definimos primero la función utilitaria
    function getTokenFromStorage() {
        return localStorage.getItem('access_token') || '';
    }

    const apiUrl = 'http://localhost:8000/maintenance';

    // ✅ Registrar mantenimiento y redirigir con token en cookie
    document.getElementById("btnMantenimiento").addEventListener("click", function() {
        const token = getTokenFromStorage();
        document.cookie = `access_token=Bearer ${token}; path=/;`;
        window.location.href = "/maintainance/crear";
    });

    // Aquí van tus otros botones como btnItinerario, btnHistorial, etc.
</script>
</body>
</html>
